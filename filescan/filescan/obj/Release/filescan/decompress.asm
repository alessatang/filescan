; Listing generated by Microsoft (R) Optimizing Compiler Version 18.00.31101.0 

	TITLE	I:\Study\filescan\filescan\decompress.c
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB OLDNAMES

PUBLIC	??_C@_1GA@MBDGFEO@?$AAL?$AAZ?$AAW?$AA?5?$AA?$CI?$AAU?$AAN?$AAI?$AAX?$AA?5?$AAc?$AAo?$AAm?$AAp?$AAr?$AAe?$AAs?$AAs?$AA?$CJ?$AA?5?$AAf?$AAi?$AAl?$AAe?$AAs?$AA?5?$AAn?$AAo?$AAt?$AA?5?$AAy?$AAe@ ; `string'
PUBLIC	??_C@_1EA@IGLHJHLH@?$AAZ?$AAi?$AAp?$AA?5?$AAf?$AAi?$AAl?$AAe?$AAs?$AA?5?$AAn?$AAo?$AAt?$AA?5?$AAy?$AAe?$AAt?$AA?5?$AAs?$AAu?$AAp?$AAp?$AAo?$AAr?$AAt?$AAe?$AAd?$AA?3?$AA?5?$AA?$CF?$AAs?$AA?$AA@ ; `string'
PUBLIC	??_C@_1DE@IECDBBFO@?$AAF?$AAi?$AAl?$AAe?$AA?5?$AA?$CF?$AAs?$AA?5?$AAi?$AAs?$AA?5?$AAn?$AAo?$AAt?$AA?5?$AAc?$AAo?$AAm?$AAp?$AAr?$AAe?$AAs?$AAs?$AAe?$AAd?$AA?$AA@ ; `string'
PUBLIC	??_C@_1EC@FMIAMKCI@?$AAU?$AAn?$AAs?$AAu?$AAp?$AAp?$AAo?$AAr?$AAt?$AAe?$AAd?$AA?5?$AAc?$AAo?$AAm?$AAp?$AAr?$AAe?$AAs?$AAs?$AAi?$AAo?$AAn?$AA?5?$AAt?$AAy?$AAp?$AAe?$AA?3?$AA?5?$AA?$CF?$AAd@ ; `string'
PUBLIC	??_C@_1DI@NIAFDAPN@?$AAF?$AAo?$AAu?$AAn?$AAd?$AA?5?$AAc?$AAo?$AAm?$AAp?$AAr?$AAe?$AAs?$AAs?$AA?9?$AAb?$AAa?$AAs?$AAe?$AAd?$AA?5?$AAs?$AAt?$AAr?$AAe?$AAa?$AAm?$AA?$AA@ ; `string'
PUBLIC	??_C@_1CO@MBLOBKFG@?$AAF?$AAo?$AAu?$AAn?$AAd?$AA?5?$AAz?$AAi?$AAp?$AA?9?$AAb?$AAa?$AAs?$AAe?$AAd?$AA?5?$AAs?$AAt?$AAr?$AAe?$AAa?$AAm?$AA?$AA@ ; `string'
;	COMDAT ??_C@_1CO@MBLOBKFG@?$AAF?$AAo?$AAu?$AAn?$AAd?$AA?5?$AAz?$AAi?$AAp?$AA?9?$AAb?$AAa?$AAs?$AAe?$AAd?$AA?5?$AAs?$AAt?$AAr?$AAe?$AAa?$AAm?$AA?$AA@
CONST	SEGMENT
??_C@_1CO@MBLOBKFG@?$AAF?$AAo?$AAu?$AAn?$AAd?$AA?5?$AAz?$AAi?$AAp?$AA?9?$AAb?$AAa?$AAs?$AAe?$AAd?$AA?5?$AAs?$AAt?$AAr?$AAe?$AAa?$AAm?$AA?$AA@ DB 'F'
	DB	00H, 'o', 00H, 'u', 00H, 'n', 00H, 'd', 00H, ' ', 00H, 'z', 00H
	DB	'i', 00H, 'p', 00H, '-', 00H, 'b', 00H, 'a', 00H, 's', 00H, 'e'
	DB	00H, 'd', 00H, ' ', 00H, 's', 00H, 't', 00H, 'r', 00H, 'e', 00H
	DB	'a', 00H, 'm', 00H, 00H, 00H			; `string'
CONST	ENDS
;	COMDAT ??_C@_1DI@NIAFDAPN@?$AAF?$AAo?$AAu?$AAn?$AAd?$AA?5?$AAc?$AAo?$AAm?$AAp?$AAr?$AAe?$AAs?$AAs?$AA?9?$AAb?$AAa?$AAs?$AAe?$AAd?$AA?5?$AAs?$AAt?$AAr?$AAe?$AAa?$AAm?$AA?$AA@
CONST	SEGMENT
??_C@_1DI@NIAFDAPN@?$AAF?$AAo?$AAu?$AAn?$AAd?$AA?5?$AAc?$AAo?$AAm?$AAp?$AAr?$AAe?$AAs?$AAs?$AA?9?$AAb?$AAa?$AAs?$AAe?$AAd?$AA?5?$AAs?$AAt?$AAr?$AAe?$AAa?$AAm?$AA?$AA@ DB 'F'
	DB	00H, 'o', 00H, 'u', 00H, 'n', 00H, 'd', 00H, ' ', 00H, 'c', 00H
	DB	'o', 00H, 'm', 00H, 'p', 00H, 'r', 00H, 'e', 00H, 's', 00H, 's'
	DB	00H, '-', 00H, 'b', 00H, 'a', 00H, 's', 00H, 'e', 00H, 'd', 00H
	DB	' ', 00H, 's', 00H, 't', 00H, 'r', 00H, 'e', 00H, 'a', 00H, 'm'
	DB	00H, 00H, 00H				; `string'
CONST	ENDS
;	COMDAT ??_C@_1EC@FMIAMKCI@?$AAU?$AAn?$AAs?$AAu?$AAp?$AAp?$AAo?$AAr?$AAt?$AAe?$AAd?$AA?5?$AAc?$AAo?$AAm?$AAp?$AAr?$AAe?$AAs?$AAs?$AAi?$AAo?$AAn?$AA?5?$AAt?$AAy?$AAp?$AAe?$AA?3?$AA?5?$AA?$CF?$AAd@
CONST	SEGMENT
??_C@_1EC@FMIAMKCI@?$AAU?$AAn?$AAs?$AAu?$AAp?$AAp?$AAo?$AAr?$AAt?$AAe?$AAd?$AA?5?$AAc?$AAo?$AAm?$AAp?$AAr?$AAe?$AAs?$AAs?$AAi?$AAo?$AAn?$AA?5?$AAt?$AAy?$AAp?$AAe?$AA?3?$AA?5?$AA?$CF?$AAd@ DB 'U'
	DB	00H, 'n', 00H, 's', 00H, 'u', 00H, 'p', 00H, 'p', 00H, 'o', 00H
	DB	'r', 00H, 't', 00H, 'e', 00H, 'd', 00H, ' ', 00H, 'c', 00H, 'o'
	DB	00H, 'm', 00H, 'p', 00H, 'r', 00H, 'e', 00H, 's', 00H, 's', 00H
	DB	'i', 00H, 'o', 00H, 'n', 00H, ' ', 00H, 't', 00H, 'y', 00H, 'p'
	DB	00H, 'e', 00H, ':', 00H, ' ', 00H, '%', 00H, 'd', 00H, 00H, 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_1DE@IECDBBFO@?$AAF?$AAi?$AAl?$AAe?$AA?5?$AA?$CF?$AAs?$AA?5?$AAi?$AAs?$AA?5?$AAn?$AAo?$AAt?$AA?5?$AAc?$AAo?$AAm?$AAp?$AAr?$AAe?$AAs?$AAs?$AAe?$AAd?$AA?$AA@
CONST	SEGMENT
??_C@_1DE@IECDBBFO@?$AAF?$AAi?$AAl?$AAe?$AA?5?$AA?$CF?$AAs?$AA?5?$AAi?$AAs?$AA?5?$AAn?$AAo?$AAt?$AA?5?$AAc?$AAo?$AAm?$AAp?$AAr?$AAe?$AAs?$AAs?$AAe?$AAd?$AA?$AA@ DB 'F'
	DB	00H, 'i', 00H, 'l', 00H, 'e', 00H, ' ', 00H, '%', 00H, 's', 00H
	DB	' ', 00H, 'i', 00H, 's', 00H, ' ', 00H, 'n', 00H, 'o', 00H, 't'
	DB	00H, ' ', 00H, 'c', 00H, 'o', 00H, 'm', 00H, 'p', 00H, 'r', 00H
	DB	'e', 00H, 's', 00H, 's', 00H, 'e', 00H, 'd', 00H, 00H, 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_1EA@IGLHJHLH@?$AAZ?$AAi?$AAp?$AA?5?$AAf?$AAi?$AAl?$AAe?$AAs?$AA?5?$AAn?$AAo?$AAt?$AA?5?$AAy?$AAe?$AAt?$AA?5?$AAs?$AAu?$AAp?$AAp?$AAo?$AAr?$AAt?$AAe?$AAd?$AA?3?$AA?5?$AA?$CF?$AAs?$AA?$AA@
CONST	SEGMENT
??_C@_1EA@IGLHJHLH@?$AAZ?$AAi?$AAp?$AA?5?$AAf?$AAi?$AAl?$AAe?$AAs?$AA?5?$AAn?$AAo?$AAt?$AA?5?$AAy?$AAe?$AAt?$AA?5?$AAs?$AAu?$AAp?$AAp?$AAo?$AAr?$AAt?$AAe?$AAd?$AA?3?$AA?5?$AA?$CF?$AAs?$AA?$AA@ DB 'Z'
	DB	00H, 'i', 00H, 'p', 00H, ' ', 00H, 'f', 00H, 'i', 00H, 'l', 00H
	DB	'e', 00H, 's', 00H, ' ', 00H, 'n', 00H, 'o', 00H, 't', 00H, ' '
	DB	00H, 'y', 00H, 'e', 00H, 't', 00H, ' ', 00H, 's', 00H, 'u', 00H
	DB	'p', 00H, 'p', 00H, 'o', 00H, 'r', 00H, 't', 00H, 'e', 00H, 'd'
	DB	00H, ':', 00H, ' ', 00H, '%', 00H, 's', 00H, 00H, 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_1GA@MBDGFEO@?$AAL?$AAZ?$AAW?$AA?5?$AA?$CI?$AAU?$AAN?$AAI?$AAX?$AA?5?$AAc?$AAo?$AAm?$AAp?$AAr?$AAe?$AAs?$AAs?$AA?$CJ?$AA?5?$AAf?$AAi?$AAl?$AAe?$AAs?$AA?5?$AAn?$AAo?$AAt?$AA?5?$AAy?$AAe@
CONST	SEGMENT
??_C@_1GA@MBDGFEO@?$AAL?$AAZ?$AAW?$AA?5?$AA?$CI?$AAU?$AAN?$AAI?$AAX?$AA?5?$AAc?$AAo?$AAm?$AAp?$AAr?$AAe?$AAs?$AAs?$AA?$CJ?$AA?5?$AAf?$AAi?$AAl?$AAe?$AAs?$AA?5?$AAn?$AAo?$AAt?$AA?5?$AAy?$AAe@ DB 'L'
	DB	00H, 'Z', 00H, 'W', 00H, ' ', 00H, '(', 00H, 'U', 00H, 'N', 00H
	DB	'I', 00H, 'X', 00H, ' ', 00H, 'c', 00H, 'o', 00H, 'm', 00H, 'p'
	DB	00H, 'r', 00H, 'e', 00H, 's', 00H, 's', 00H, ')', 00H, ' ', 00H
	DB	'f', 00H, 'i', 00H, 'l', 00H, 'e', 00H, 's', 00H, ' ', 00H, 'n'
	DB	00H, 'o', 00H, 't', 00H, ' ', 00H, 'y', 00H, 'e', 00H, 't', 00H
	DB	' ', 00H, 's', 00H, 'u', 00H, 'p', 00H, 'p', 00H, 'o', 00H, 'r'
	DB	00H, 't', 00H, 'e', 00H, 'd', 00H, ':', 00H, ' ', 00H, '%', 00H
	DB	's', 00H, 00H, 00H				; `string'
PUBLIC	?is_zipped@@YA?AW4ag_compression_type@@PBXH@Z	; is_zipped
PUBLIC	?decompress@@YAPAXW4ag_compression_type@@PBXHPB_WPAH@Z ; decompress
; Function compile flags: /Ogtp
;	COMDAT ?decompress_lzw@@YAPAXPBXHPB_WPAH@Z
_TEXT	SEGMENT
_dir_full_path$ = 8					; size = 4
_new_buf_len$ = 12					; size = 4
?decompress_lzw@@YAPAXPBXHPB_WPAH@Z PROC		; decompress_lzw, COMDAT
; _buf$dead$ = ecx
; _buf_len$dead$ = edx
; File i:\study\filescan\filescan\decompress.c
; Line 105
	push	ebp
	mov	ebp, esp
; Line 108
	push	DWORD PTR _dir_full_path$[ebp]
	push	OFFSET ??_C@_1GA@MBDGFEO@?$AAL?$AAZ?$AAW?$AA?5?$AA?$CI?$AAU?$AAN?$AAI?$AAX?$AA?5?$AAc?$AAo?$AAm?$AAp?$AAr?$AAe?$AAs?$AAs?$AA?$CJ?$AA?5?$AAf?$AAi?$AAl?$AAe?$AAs?$AA?5?$AAn?$AAo?$AAt?$AA?5?$AAy?$AAe@
	call	?log_err@@YAXPB_WZZ			; log_err
; Line 109
	mov	eax, DWORD PTR _new_buf_len$[ebp]
	add	esp, 8
	mov	DWORD PTR [eax], 0
; Line 110
	xor	eax, eax
; Line 111
	pop	ebp
	ret	0
?decompress_lzw@@YAPAXPBXHPB_WPAH@Z ENDP		; decompress_lzw
_TEXT	ENDS
; Function compile flags: /Ogtp
;	COMDAT ?decompress_zip@@YAPAXPBXHPB_WPAH@Z
_TEXT	SEGMENT
_dir_full_path$ = 8					; size = 4
_new_buf_len$ = 12					; size = 4
?decompress_zip@@YAPAXPBXHPB_WPAH@Z PROC		; decompress_zip, COMDAT
; _buf$dead$ = ecx
; _buf_len$dead$ = edx
; File i:\study\filescan\filescan\decompress.c
; Line 115
	push	ebp
	mov	ebp, esp
; Line 118
	push	DWORD PTR _dir_full_path$[ebp]
	push	OFFSET ??_C@_1EA@IGLHJHLH@?$AAZ?$AAi?$AAp?$AA?5?$AAf?$AAi?$AAl?$AAe?$AAs?$AA?5?$AAn?$AAo?$AAt?$AA?5?$AAy?$AAe?$AAt?$AA?5?$AAs?$AAu?$AAp?$AAp?$AAo?$AAr?$AAt?$AAe?$AAd?$AA?3?$AA?5?$AA?$CF?$AAs?$AA?$AA@
	call	?log_err@@YAXPB_WZZ			; log_err
; Line 119
	mov	eax, DWORD PTR _new_buf_len$[ebp]
	add	esp, 8
	mov	DWORD PTR [eax], 0
; Line 120
	xor	eax, eax
; Line 121
	pop	ebp
	ret	0
?decompress_zip@@YAPAXPBXHPB_WPAH@Z ENDP		; decompress_zip
_TEXT	ENDS
; Function compile flags: /Ogtp
;	COMDAT ?decompress@@YAPAXW4ag_compression_type@@PBXHPB_WPAH@Z
_TEXT	SEGMENT
_buf_len$dead$ = 8					; size = 4
_dir_full_path$ = 12					; size = 4
_new_buf_len$ = 16					; size = 4
?decompress@@YAPAXW4ag_compression_type@@PBXHPB_WPAH@Z PROC ; decompress, COMDAT
; _zip_type$ = ecx
; _buf$dead$ = edx
; File i:\study\filescan\filescan\decompress.c
; Line 193
	push	ebp
	mov	ebp, esp
; Line 194
	mov	eax, ecx
	sub	eax, 0
	je	SHORT $LN2@decompress
	sub	eax, 2
	je	SHORT $LN4@decompress
	dec	eax
	je	SHORT $LN3@decompress
; Line 211
	push	ecx
	push	OFFSET ??_C@_1EC@FMIAMKCI@?$AAU?$AAn?$AAs?$AAu?$AAp?$AAp?$AAo?$AAr?$AAt?$AAe?$AAd?$AA?5?$AAc?$AAo?$AAm?$AAp?$AAr?$AAe?$AAs?$AAs?$AAi?$AAo?$AAn?$AA?5?$AAt?$AAy?$AAp?$AAe?$AA?3?$AA?5?$AA?$CF?$AAd@
	jmp	SHORT $LN13@decompress
$LN3@decompress:
; Line 118
	push	DWORD PTR _dir_full_path$[ebp]
	push	OFFSET ??_C@_1EA@IGLHJHLH@?$AAZ?$AAi?$AAp?$AA?5?$AAf?$AAi?$AAl?$AAe?$AAs?$AA?5?$AAn?$AAo?$AAt?$AA?5?$AAy?$AAe?$AAt?$AA?5?$AAs?$AAu?$AAp?$AAp?$AAo?$AAr?$AAt?$AAe?$AAd?$AA?3?$AA?5?$AA?$CF?$AAs?$AA?$AA@
; Line 202
	jmp	SHORT $LN13@decompress
$LN4@decompress:
; Line 108
	push	DWORD PTR _dir_full_path$[ebp]
	push	OFFSET ??_C@_1GA@MBDGFEO@?$AAL?$AAZ?$AAW?$AA?5?$AA?$CI?$AAU?$AAN?$AAI?$AAX?$AA?5?$AAc?$AAo?$AAm?$AAp?$AAr?$AAe?$AAs?$AAs?$AA?$CJ?$AA?5?$AAf?$AAi?$AAl?$AAe?$AAs?$AA?5?$AAn?$AAo?$AAt?$AA?5?$AAy?$AAe@
; Line 200
	jmp	SHORT $LN13@decompress
$LN2@decompress:
; Line 208
	push	DWORD PTR _dir_full_path$[ebp]
	push	OFFSET ??_C@_1DE@IECDBBFO@?$AAF?$AAi?$AAl?$AAe?$AA?5?$AA?$CF?$AAs?$AA?5?$AAi?$AAs?$AA?5?$AAn?$AAo?$AAt?$AA?5?$AAc?$AAo?$AAm?$AAp?$AAr?$AAe?$AAs?$AAs?$AAe?$AAd?$AA?$AA@
$LN13@decompress:
	call	?log_err@@YAXPB_WZZ			; log_err
; Line 214
	mov	eax, DWORD PTR _new_buf_len$[ebp]
	add	esp, 8
	mov	DWORD PTR [eax], 0
; Line 215
	xor	eax, eax
; Line 216
	pop	ebp
	ret	0
?decompress@@YAPAXW4ag_compression_type@@PBXHPB_WPAH@Z ENDP ; decompress
_TEXT	ENDS
; Function compile flags: /Ogtp
;	COMDAT ?is_zipped@@YA?AW4ag_compression_type@@PBXH@Z
_TEXT	SEGMENT
?is_zipped@@YA?AW4ag_compression_type@@PBXH@Z PROC	; is_zipped, COMDAT
; _buf$ = ecx
; _buf_len$ = edx
; File i:\study\filescan\filescan\decompress.c
; Line 234
	test	edx, edx
	jne	SHORT $LN8@is_zipped
; Line 235
	xor	eax, eax
; Line 278
	ret	0
$LN8@is_zipped:
	push	esi
; Line 238
	cmp	edx, 2
	jl	SHORT $LN3@is_zipped
; Line 239
	cmp	WORD PTR [ecx], 31			; 0000001fH
	jne	SHORT $LN3@is_zipped
; Line 240
	movzx	eax, WORD PTR [ecx+2]
	mov	esi, 139				; 0000008bH
	cmp	ax, si
	je	SHORT $LN3@is_zipped
; Line 245
	mov	esi, 155				; 0000009bH
	cmp	ax, si
	jne	SHORT $LN3@is_zipped
; Line 246
	push	OFFSET ??_C@_1DI@NIAFDAPN@?$AAF?$AAo?$AAu?$AAn?$AAd?$AA?5?$AAc?$AAo?$AAm?$AAp?$AAr?$AAe?$AAs?$AAs?$AA?9?$AAb?$AAa?$AAs?$AAe?$AAd?$AA?5?$AAs?$AAt?$AAr?$AAe?$AAa?$AAm?$AA?$AA@
	call	?log_debug@@YAXPB_WZZ			; log_debug
	add	esp, 4
; Line 247
	mov	eax, 2
	pop	esi
; Line 278
	ret	0
$LN3@is_zipped:
; Line 253
	cmp	edx, 4
	jl	SHORT $LN1@is_zipped
; Line 254
	cmp	WORD PTR [ecx], 80			; 00000050H
	jne	SHORT $LN1@is_zipped
	cmp	WORD PTR [ecx+2], 75			; 0000004bH
	jne	SHORT $LN1@is_zipped
	cmp	WORD PTR [ecx+4], 3
	jne	SHORT $LN1@is_zipped
	cmp	WORD PTR [ecx+6], 4
	jne	SHORT $LN1@is_zipped
; Line 255
	push	OFFSET ??_C@_1CO@MBLOBKFG@?$AAF?$AAo?$AAu?$AAn?$AAd?$AA?5?$AAz?$AAi?$AAp?$AA?9?$AAb?$AAa?$AAs?$AAe?$AAd?$AA?5?$AAs?$AAt?$AAr?$AAe?$AAa?$AAm?$AA?$AA@
	call	?log_debug@@YAXPB_WZZ			; log_debug
	add	esp, 4
; Line 256
	mov	eax, 3
	pop	esi
; Line 278
	ret	0
$LN1@is_zipped:
; Line 277
	xor	eax, eax
	pop	esi
; Line 278
	ret	0
?is_zipped@@YA?AW4ag_compression_type@@PBXH@Z ENDP	; is_zipped
_TEXT	ENDS
END
